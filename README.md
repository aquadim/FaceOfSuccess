# Лицо успеха
## О проекте
Лицо успеха - система, позволяющая студентам собрать все фотографии, на которых они присутствуют, всего лишь сфотографировавшись.

## Установка
Проект протестирован в окружении:
|Компонент| Версия              |
|--       |--                   |
| ОС      | Debian GNU/Linux 12 |
| python  | 3.11.2              |
| Браузер | Firefox 134.0.61    |
| npm     | 9.2.0               |
| RAM			| 8GB									|
| CPU			| 4 400 Gz						|
### Установка зависимостей
#### Нейродвижок
Нейродвижок устанавливается **на сервере**.
Для компиляции dlib (зависимость нейродвижка) необходимо предварительно установить следующие пакеты:
|Дистрибутив Linux| Пакеты |
|--|--|
| Debian/Ubuntu | build-essential, cmake, libopenblas-dev, liblapack-dev, python3, python3-virtualenv |
1. Перейти в каталог /src/face-api: `cd ./src/face-api`
2. Создать виртуальную среду (virtualenv): `python3 -m venv ./venv`
3. Активировать виртуальную среду: `source ./venv/bin/activate`
4. Установить зависимости с помощью pip: `pip install -r requirements.txt`
#### Файловый API
Файловый API используется для взаимодействия с устройствами на клиенте, поэтому должен устанавливаться **на клиенте**.
1. Перейти в каталог /src/file-api: `cd ./src/file-api`
2. Создать виртуальную среду (virtualenv): `python3 -m venv ./venv`
3. Активировать виртуальную среду: `source ./venv/bin/activate`
4. Установить зависимости с помощью pip: `pip install -r requirements.txt`
#### Интерфейс
Интерфейс работает в клиент-серверном режиме. Клиент получает HTML в браузере, а сам HTML формируется на сервере. Поэтому интерфейс устанавливается **на сервере**.
1. Перейти в каталог /src/web: `cd ./src/web`
2. Установить зависимости с помощью npm: `npm install`
3. Собрать проект: `npm build`
4. Скопировать получившийся каталог dist в публичный каталог веб-сервера (apache, ngnix, iis)

## Настройка
### Интерфейс
1. Переименовать `./src/web/src/config.js.example` в `./src/web/src/config.js`
2. Подставить в файл соответствующие значения:
	2.1. filesystemApiUrl - по такому адресу **клиент** будет обращаться к **своему** файловому API, поэтому `http://localhost:8001` подойдёт для большинства случаев. По умолчанию файловое API как раз запускается на порту 8001.
	2.2 faceApiUrl - по такому адресу **клиент** будет обращаться к **серверному** API нейродвижка. Здесь нужно указать адрес и порт сервера на котором работает это API. По умолчанию прослушивается порт 8000.
	2.3 disableUSBChecks - отключить проверку подключения USB. Результат нейродвижка не сможет сохраняться.

## Запуск
### Нейродвижок
1. Активировать virtualenv `source ./src/face-api/venv/bin/activate`
2. Запустить скрипт `./src/face-api/start.sh`
API должно запуститься и прослушивать порт **8000**
### Интерфейс: Сервер
При установке каталог dist должен уже содержать всё необходимое.

### Интерфейс: Клиент
#### 1. Запустить файловый API 
1. Активировать virtualenv `source ./src/file-api/venv/bin/activate`
2. Запустить скрипт `./src/file-api/start.sh`
В git ветке `no-usb-check` файловый API можно не запускать.
#### 2. Открыть браузер
1. Понять какой IP адрес у сервера интерфейса
2. Открыть URL с каталогом dist
